<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tahleel Notes</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/942/942748.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --text-dark:#1e293b;--text-light:#f8fafc;--muted-dark:#94a3b8;--accent:linear-gradient(135deg,#6d28d9,#2563eb);
      --glass-light:rgba(255,255,255,0.25);--glass-dark:rgba(0,0,0,0.35);--glass-border:rgba(255,255,255,0.3);
      --bg-light:linear-gradient(135deg,#e0e7ff 0%,#bae6fd 50%,#fef9c3 100%);
      --bg-dark:linear-gradient(135deg,#0f172a 0%,#1e1b4b 60%,#312e81 100%);
    }
    body{margin:0;font-family:Poppins;height:100vh;display:flex;flex-direction:column;align-items:center;padding:30px;
      color:var(--text-dark);background:var(--bg-light);transition:background .6s,color .6s;}
    header{display:flex;justify-content:space-between;align-items:center;width:100%;max-width:1200px;margin-bottom:24px;}
    .logo{font-size:28px;width:60px;height:60px;display:grid;place-items:center;border-radius:14px;background:var(--glass-light);backdrop-filter:blur(20px);border:1px solid var(--glass-border);box-shadow:0 4px 30px rgba(0,0,0,.2);}
    .title-wrap{display:flex;flex-direction:column;}
    .title{font-size:22px;font-weight:600;letter-spacing:.3px;}
    .subtitle{font-size:14px;color:var(--muted-dark);}
    .toolbar{display:flex;gap:8px;align-items:center;}
    button{background:rgba(255,255,255,0.25);border:1px solid var(--glass-border);backdrop-filter:blur(20px);border-radius:10px;padding:8px 12px;cursor:pointer;font-weight:500;transition:.3s;}
    button:hover{box-shadow:0 0 10px rgba(255,255,255,0.3);}
    .input-section{width:100%;max-width:800px;margin-bottom:20px;display:flex;flex-direction:column;gap:10px;}
    .input-section input,.input-section textarea{width:100%;padding:10px 14px;border-radius:12px;border:1px solid var(--glass-border);background:var(--glass-light);backdrop-filter:blur(20px);font-family:Poppins;font-size:14px;}
    .input-section button{align-self:flex-end;background:var(--accent);color:white;border:none;padding:10px 20px;border-radius:10px;}
    .search-bar{width:100%;max-width:600px;margin-bottom:20px;display:flex;gap:10px;}
    .search-bar input{flex:1;padding:10px 14px;border-radius:10px;border:1px solid var(--glass-border);background:var(--glass-light);backdrop-filter:blur(20px);}
    .notes{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px;width:100%;max-width:1200px;}
    .card{position:relative;padding:18px;border-radius:20px;background:var(--glass-light);border:1px solid var(--glass-border);backdrop-filter:blur(25px);box-shadow:0 8px 32px rgba(0,0,0,0.25);transition:.3s;}
    .card:hover{transform:translateY(-4px);}
    .note-title{font-weight:600;font-size:16px;margin-bottom:6px;}
    .note-text{font-size:14px;white-space:pre-wrap;cursor:pointer;}
    .actions{position:absolute;top:8px;right:8px;display:flex;gap:8px;}
    .icon-btn{background:rgba(255,255,255,0.2);border:none;border-radius:6px;padding:6px;cursor:pointer;}
    .icon-btn:hover{background:rgba(255,255,255,0.35);}
    .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.7);color:#fff;padding:10px 16px;border-radius:10px;backdrop-filter:blur(10px);opacity:0;transition:opacity .3s;z-index:999;}
    .toast.show{opacity:1;}
    .dark-mode{background:var(--bg-dark);color:var(--text-light);}
    .dark-mode button{color:var(--text-light);background:var(--glass-dark);}
    .dark-mode .card{background:var(--glass-dark);color:var(--text-light);}
    @media(max-width:720px){body{padding:20px;}}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:14px;">
      <div class="logo">üßä</div>
      <div class="title-wrap">
        <div class="title">Tahleel Notes</div>
        <div class="subtitle">Your modern crystal glass notes</div>
      </div>
    </div>
    <div class="toolbar">
      <button id="themeToggle">üåô Dark</button>
      <button id="clearAll">üóëÔ∏è Clear</button>
    </div>
  </header>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="üîç Search notes by title or content...">
  </div>

  <div class="input-section">
    <input type="text" id="noteTitle" placeholder="Title">
    <textarea id="noteText" rows="4" placeholder="Write your note..."></textarea>
    <button id="createNote">Create Note</button>
  </div>

  <div class="notes" id="notes"></div>
  <div class="toast" id="toast">Copied!</div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, updateDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC6KT2ARiHfTquxCYqzaOGSmrrlat0Z3J8",
      authDomain: "tahleel-notes.firebaseapp.com",
      projectId: "tahleel-notes",
      storageBucket: "tahleel-notes.firebasestorage.app",
      messagingSenderId: "82024240139",
      appId: "1:82024240139:web:bcd38c713b1bebe6dc230e"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const notesRef = collection(db, "notes");

    const notesContainer = document.getElementById('notes');
    const createBtn = document.getElementById('createNote');
    const noteTitle = document.getElementById('noteTitle');
    const noteText = document.getElementById('noteText');
    const clearBtn = document.getElementById('clearAll');
    const themeToggle = document.getElementById('themeToggle');
    const toast = document.getElementById('toast');
    const searchInput = document.getElementById('searchInput');

    function showToast(msg='Copied!'){
      toast.textContent=msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'),1200);
    }

    function renderNotes(snapshot){
      notesContainer.innerHTML='';
      const queryText = searchInput.value.toLowerCase();
      snapshot.docs
        .filter(doc => {
          const data = doc.data();
          return data.title.toLowerCase().includes(queryText) || data.text.toLowerCase().includes(queryText);
        })
        .forEach(docSnap=>{
          const note=docSnap.data();
          const id=docSnap.id;
          const card=document.createElement('div');card.className='card';
          card.innerHTML=`
            <div class='note-title'>${note.title}</div>
            <div class='note-text'>${note.text}</div>
            <div class='actions'>
              <button class='icon-btn copy' title='Copy'>üìã</button>
              <button class='icon-btn edit' title='Edit'>‚úèÔ∏è</button>
              <button class='icon-btn del' title='Delete'>üóëÔ∏è</button>
            </div>`;
          card.querySelector('.copy').onclick=(e)=>{e.stopPropagation();navigator.clipboard.writeText(note.text);showToast('Text copied!');};
          card.querySelector('.del').onclick=async(e)=>{e.stopPropagation();await deleteDoc(doc(db,"notes",id));};
          card.querySelector('.edit').onclick=async(e)=>{
            e.stopPropagation();
            const newTitle=prompt('Edit title',note.title)||note.title;
            const newText=prompt('Edit text',note.text)||note.text;
            await updateDoc(doc(db,"notes",id),{title:newTitle,text:newText});
          };
          notesContainer.appendChild(card);
        });
    }

    // Real-time listener
    onSnapshot(query(notesRef, orderBy("created","desc")),renderNotes);

    createBtn.onclick=async()=>{
      const title=noteTitle.value.trim();
      const text=noteText.value.trim();
      if(!text) return;
      await addDoc(notesRef,{title:title||'Untitled',text,created:Date.now()});
      noteTitle.value='';noteText.value='';
    };

    clearBtn.onclick=async()=>{
      if(confirm('Delete all notes?')){
        const snapshot = await onSnapshot(notesRef,()=>{});
        snapshot.forEach(async docSnap => await deleteDoc(doc(db,"notes",docSnap.id)));
      }
    };

    themeToggle.onclick=()=>{document.body.classList.toggle('dark-mode');themeToggle.textContent=document.body.classList.contains('dark-mode')?'üå§ Light':'üåô Dark';};
    searchInput.oninput=()=>onSnapshot(query(notesRef, orderBy("created","desc")),renderNotes);
  </script>
</body>
</html>
